---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(DBI)
library(dragracer)
library(glue)
library(here)
library(flexdashboard)
source(here("Functions","db_helper_functions.R"))
```

```{r read in data from dragracer, ehco=FALSE}
contestants_episode <- dragracer::rpdr_contep

contestants <- dragracer::rpdr_contestants

episodes <- dragracer::rpdr_ep

```


```{r create sqlite database to load frames, echo=FALSE}
rpdr_conn <- DBI::dbConnect(RSQLite::SQLite(), dbname="rpdr.sqlite")

# create tables and define primary keys

#DBI::dbWriteTable(conn=db_conn, name="cntstnt_ep", value = contestants_episode)
```


```{r}
rpdr_conn <- DBI::dbConnect(RSQLite::SQLite(), dbname="rpdr.sqlite")
db_create_table( db_conn=rpdr_conn
                , file_location = "SQL"
                , file_name = "db_create_table.sql"
                , df_in = contestants
                , tbl_name = "test"
                , pk_val=c("col_name","col_name_2")
                )
```

