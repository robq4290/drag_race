---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(DBI)
library(dragracer)
library(glue)
library(here)
library(flexdashboard)
source(here("Functions","db_helper_functions.R"))
```

```{r read in data from dragracer, ehco=FALSE}
contestants_episode <- dragracer::rpdr_contep

contestants <- dragracer::rpdr_contestants

episodes <- dragracer::rpdr_ep

```


```{r create sqlite database to load frames}
rpdr_conn <- DBI::dbConnect(RSQLite::SQLite(), dbname="rpdr.sqlite")

# create tables and define primary keys

# Contestant Episode
db_create_table( db_conn=rpdr_conn
                , file_location = "SQL"
                , file_name = "db_create_table.sql"
                , df_in = contestants_episode
                , tbl_name = "cntstnt_ep"
                , pk_val=list("contestant","season","episode")
                )

# Contestant
db_create_table( db_conn=rpdr_conn
                , file_location = "SQL"
                , file_name = "db_create_table.sql"
                , df_in = contestants
                , tbl_name = "cntstnt"
                , pk_val=list("contestant","season")
                )

# Episodes

db_create_table( db_conn=rpdr_conn
                , file_location = "SQL"
                , file_name = "db_create_table.sql"
                , df_in = episodes
                , tbl_name = "episds"
                , pk_val=list("season","episode")
                )

```


```{r}
rpdr_conn <- DBI::dbConnect(RSQLite::SQLite(), dbname="rpdr.sqlite")
df_tst <- db_exec_query(  db_conn = rpdr_conn
                        , file_location = "SQL"
                        , file_name = "example_join.sql")

```

```{r}
DBI::dbDisconnect(rpdr_conn)
```

